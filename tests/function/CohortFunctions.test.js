import expect from 'expect';
import {
  fetchCohortData,
  getAllSubCohortPossibleSamples,
  getGenesForNamedPathways,
  getGenesForPathways,
  getSamplesFromSelectedSubCohorts,
  getSamplesFromSubCohort,
  getSamplesFromSubCohortList,
  getSubCohortsOnlyForCohort, matchFilters,
} from '../../src/functions/CohortFunctions';
import TestDefaultCohortData from '../data/TestDefaultCohortData';
import SamplePathway1 from '../data/SamplePathway1';
import {UNASSIGNED_SUBTYPE} from '../../src/components/SubCohortSelector';
import {calculateSelectedSubCohortSamples} from '../../src/functions/FetchFunctions';
import {FILTER_ENUM} from '../../src/components/ViewSelector';
const TEST_MESOTHELIOMA_SAMPLES = ['TCGA-3H-AB3K-01','TCGA-3H-AB3L-01','TCGA-3H-AB3M-01','TCGA-3H-AB3O-01','TCGA-3H-AB3S-01','TCGA-3H-AB3T-01','TCGA-3H-AB3U-01','TCGA-3H-AB3X-01','TCGA-3U-A98D-01','TCGA-3U-A98E-01','TCGA-3U-A98F-01','TCGA-3U-A98G-01','TCGA-3U-A98H-01','TCGA-3U-A98I-01','TCGA-3U-A98J-01','TCGA-LK-A4NW-01','TCGA-LK-A4NY-01','TCGA-LK-A4NZ-01','TCGA-LK-A4O0-01','TCGA-LK-A4O2-01','TCGA-LK-A4O4-01','TCGA-LK-A4O5-01','TCGA-LK-A4O6-01','TCGA-LK-A4O7-01','TCGA-MQ-A4KX-01','TCGA-MQ-A4LC-01','TCGA-MQ-A4LI-01','TCGA-MQ-A4LJ-01','TCGA-MQ-A4LM-01','TCGA-MQ-A4LP-01','TCGA-MQ-A4LV-01','TCGA-MQ-A6BL-01','TCGA-MQ-A6BQ-01','TCGA-MQ-A6BR-01','TCGA-MQ-A6BS-01','TCGA-NQ-A57I-01','TCGA-NQ-A638-01','TCGA-SC-A6LM-01','TCGA-SC-A6LN-01','TCGA-SC-A6LP-01','TCGA-SC-A6LQ-01','TCGA-SC-A6LR-01','TCGA-SC-AA5Z-01','TCGA-SH-A7BC-01','TCGA-SH-A7BD-01','TCGA-SH-A7BH-01','TCGA-SH-A9CT-01','TCGA-SH-A9CU-01','TCGA-TS-A7OU-01','TCGA-TS-A7OY-01','TCGA-TS-A7OZ-01','TCGA-TS-A7P0-01','TCGA-TS-A7P1-01','TCGA-TS-A7P3-01','TCGA-TS-A7P6-01','TCGA-TS-A7P8-01','TCGA-TS-A7PB-01','TCGA-TS-A8AI-01','TCGA-TS-A8AS-01','TCGA-TS-A8AV-01','TCGA-TS-A8AY-01','TCGA-UD-AABZ-01','TCGA-UD-AAC1-01','TCGA-UD-AAC4-01','TCGA-UD-AAC5-01','TCGA-UD-AAC6-01','TCGA-UD-AAC7-01','TCGA-UT-A88C-01','TCGA-UT-A88D-01','TCGA-UT-A88E-01','TCGA-UT-A88G-01','TCGA-UT-A97Y-01','TCGA-XT-AASU-01','TCGA-YS-A95B-01','TCGA-YS-A95C-01','TCGA-YS-AA4M-01','TCGA-ZN-A9VO-01','TCGA-ZN-A9VP-01','TCGA-ZN-A9VQ-01','TCGA-ZN-A9VS-01','TCGA-ZN-A9VU-01','TCGA-ZN-A9VV-01','TCGA-ZN-A9VW-01'];
const TEST_AVAILABLE_OVARIAN_SAMPLES = ['TCGA-04-1353-01','TCGA-04-1516-01','TCGA-04-1638-01','TCGA-04-1644-01','TCGA-04-1646-01','TCGA-04-1648-01','TCGA-04-1649-01','TCGA-04-1651-01','TCGA-04-1652-01','TCGA-04-1655-01','TCGA-09-1664-01','TCGA-09-1670-01','TCGA-09-1672-01','TCGA-09-1673-01','TCGA-09-1674-01','TCGA-09-1675-01','TCGA-13-2057-01','TCGA-13-2059-01','TCGA-13-2061-01','TCGA-13-2065-01','TCGA-13-2071-01','TCGA-20-1682-01','TCGA-20-1683-01','TCGA-20-1684-01','TCGA-20-1685-01','TCGA-20-1686-01','TCGA-20-1687-01','TCGA-23-1029-01','TCGA-23-1111-01','TCGA-23-1114-01','TCGA-23-1809-01','TCGA-23-2641-01','TCGA-23-2643-01','TCGA-23-2645-01','TCGA-24-1842-01','TCGA-24-1843-01','TCGA-24-1844-01','TCGA-24-1845-01','TCGA-24-1846-01','TCGA-24-1847-01','TCGA-24-1849-01','TCGA-24-1850-01','TCGA-29-1688-01','TCGA-29-1690-01','TCGA-29-1691-01','TCGA-29-1693-01','TCGA-29-1694-01','TCGA-29-1695-01','TCGA-29-1696-01','TCGA-29-1697-01','TCGA-29-1698-01','TCGA-29-1699-01','TCGA-29-1701-01','TCGA-29-1702-01','TCGA-29-1703-01','TCGA-29-1705-01','TCGA-29-1707-01','TCGA-29-1710-01','TCGA-29-1711-01','TCGA-29-1761-01','TCGA-29-1762-01','TCGA-29-1763-01','TCGA-29-1764-01','TCGA-29-1766-01','TCGA-29-1768-01','TCGA-29-1769-01','TCGA-29-1770-01','TCGA-29-1771-01','TCGA-29-1774-01','TCGA-29-1775-01','TCGA-29-1776-01','TCGA-29-1777-01','TCGA-29-1778-01','TCGA-29-1781-01','TCGA-29-1783-01','TCGA-29-1784-01','TCGA-29-1785-01','TCGA-29-2429-01','TCGA-29-2431-01','TCGA-29-2432-01','TCGA-29-2434-01','TCGA-29-2436-01','TCGA-30-1714-01','TCGA-30-1718-01','TCGA-30-1855-01','TCGA-30-1856-01','TCGA-30-1857-01','TCGA-36-2530-01','TCGA-36-2532-01','TCGA-36-2533-01','TCGA-36-2534-01','TCGA-36-2537-01','TCGA-36-2538-01','TCGA-36-2539-01','TCGA-36-2540-01','TCGA-36-2542-01','TCGA-36-2543-01','TCGA-36-2544-01','TCGA-36-2545-01','TCGA-36-2547-01','TCGA-36-2548-01','TCGA-36-2551-01','TCGA-36-2552-01','TCGA-42-2582-01','TCGA-42-2587-01','TCGA-42-2588-01','TCGA-42-2589-01','TCGA-42-2590-01','TCGA-42-2591-01','TCGA-57-1586-01','TCGA-59-2372-01','TCGA-61-1722-01','TCGA-61-1725-01','TCGA-61-1727-01','TCGA-61-1730-01','TCGA-61-1733-01','TCGA-61-1737-01','TCGA-61-1738-01','TCGA-61-1740-01','TCGA-61-1741-01','TCGA-61-1895-01','TCGA-61-1899-01','TCGA-61-1900-01','TCGA-61-1901-01','TCGA-61-1903-01','TCGA-61-1904-01','TCGA-61-1906-01','TCGA-61-1907-01','TCGA-61-1910-01','TCGA-61-1911-01','TCGA-61-1913-01','TCGA-61-1914-01','TCGA-61-1915-01','TCGA-61-2612-01','TCGA-61-2613-01','TCGA-61-2614-01'];
const BREAST_SUBCOHORTS = {'name':'TCGA Breast Cancer (BRCA)','mutationDataSetId':'TCGA.BRCA.sampleMap/mutation_curated_wustl','copyNumberDataSetId':'TCGA.BRCA.sampleMap/Gistic2_CopyNumber_Gistic2_all_thresholded.by_genes','genomeBackgroundCopyNumber':{'host':'https://xenago.xenahubs.net','dataset':'cnv_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'genomeBackgroundMutation':{'host':'https://xenago.xenahubs.net','dataset':'mutation_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'amplificationThreshold':2,'deletionThreshold':-2,'host':'https://tcga.xenahubs.net','subCohorts':['BRCA.Basal','BRCA.Her2','BRCA.LumA','BRCA.LumB','BRCA.Normal'],'selectedSubCohorts':['BRCA.LumB']};

describe('Test Cohorts', () => {

  it('Get sub all cohort samples cohort', () => {
    let samples = getSamplesFromSubCohort('TCGA Ovarian Cancer (OV)','OVCA.Immunoreactive');
    expect(107).toEqual(samples.length);
  });

  it('Get Sub cohorts for cohort', () => {
    let subCohorts = getSubCohortsOnlyForCohort('TCGA Ovarian Cancer (OV)');
    expect(['OVCA.Differentiated', 'OVCA.Immunoreactive', 'OVCA.Mesenchymal', 'OVCA.Proliferative',UNASSIGNED_SUBTYPE.key]).toEqual(subCohorts);

  });

  it('Get sub all cohort samples cohort list', () => {
    let samples = getSamplesFromSubCohortList('TCGA Ovarian Cancer (OV)',['OVCA.Immunoreactive','OVCA.Differentiated']);
    expect(samples.length).toEqual(107+135);
  });

  it('Get samples cohort with no sub cohorts', () => {
    const selectedCohort = {
      name: 'TCGA Mesothelioma (MESO)',
      selectedSubCohorts:[],
    };
    let samples = calculateSelectedSubCohortSamples(TEST_MESOTHELIOMA_SAMPLES,selectedCohort);
    expect(samples.length).toEqual(83);
    // expect(TEST_MESOTHELIOMA_SAMPLES.length).toEqual(83);
    expect(samples).toEqual(TEST_MESOTHELIOMA_SAMPLES);
  });

  it('Get sub all cohort samples available for sub cohorts', () => {
    const selectedCohort = {
      name: 'TCGA Ovarian Cancer (OV)',
      selectedSubCohorts: ['OVCA.Immunoreactive','OVCA.Differentiated'],
      subCohorts: [UNASSIGNED_SUBTYPE.key,'OVCA.Immunoreactive','OVCA.Differentiated'],
    };
    let samples = calculateSelectedSubCohortSamples(TEST_AVAILABLE_OVARIAN_SAMPLES,selectedCohort);
    expect(samples.length).toEqual(50);
  });

  it('Get unassigned samples for cohort', () => {
    const selectedCohort = {
      name: 'TCGA Ovarian Cancer (OV)',
      selectedSubCohorts: [UNASSIGNED_SUBTYPE.key],
      subCohorts: [UNASSIGNED_SUBTYPE.key,'OVCA.Immunoreactive','OVCA.Differentiated'],
    };
    let samples = calculateSelectedSubCohortSamples(TEST_AVAILABLE_OVARIAN_SAMPLES,selectedCohort);
    expect(samples.length).toEqual(49);
  });
  //
  it('Get all samples possible for sub cohorts', () => {
    let samples = getAllSubCohortPossibleSamples('TCGA Ovarian Cancer (OV)');
    expect(samples.length).toEqual(489);
  });
  //
  it('Get ALL samples for cohort', () => {
    let selectedCohort = {
      name: 'TCGA Ovarian Cancer (OV)',
    };
    selectedCohort.selectedSubCohorts = getSubCohortsOnlyForCohort(selectedCohort.name);
    let samples = calculateSelectedSubCohortSamples(TEST_AVAILABLE_OVARIAN_SAMPLES,selectedCohort);
    expect(samples.length).toEqual(136);
  });

  it('Get sub all cohort samples sub cohorts', () => {
    const input = {
      name: 'TCGA Ovarian Cancer (OV)',
      selectedSubCohorts: ['OVCA.Immunoreactive','OVCA.Differentiated'],
      subCohorts: ['OVCA.Immunoreactive','OVCA.Differentiated'],
    };
    let samples = getSamplesFromSelectedSubCohorts(input);
    expect(samples.length).toEqual(107+135);
  });

  it('Get Cohort Data',() => {
    expect(TestDefaultCohortData).toEqual(fetchCohortData());
  });

  it('Get Genes for Pathways',() => {
    const inputPathways = [{'goid':'GO:0007219','golabel':'Notch signaling','gene':['DLL1','DTX1','JAG1','JAG2','ADAM10','PSEN1','PSEN2','PSENEN'],'firstObserved':53,'firstTotal':68,'firstNumSamples':136,'firstExpected':44.66612281988055,'firstChiSquared':2.3153835851527638,'secondObserved':51,'secondTotal':64,'secondNumSamples':492,'secondExpected':68.06036182105755,'secondChiSquared':-4.962988850440012},{'goid':'GO:0035329','golabel':'Hippo signaling','gene':['LATS2','MOB1B','MOB1A','SAV1','STK3','STK4','TAZ','YAP1','MST1','WWTR1'],'firstObserved':66,'firstTotal':98,'firstNumSamples':136,'firstExpected':52.1623051662852,'firstChiSquared':5.954842807339839,'secondObserved':89,'secondTotal':104,'secondNumSamples':492,'secondExpected':81.4868086677341,'secondChiSquared':0.8302322008912479},{'goid':'GO:0006281','golabel':'DNA base excision repair','gene':['UNG','SMUG1','MBD4','TDG','OGG1','MUTYH','NTHL1','MPG','NEIL1','NEIL2','NEIL3'],'firstObserved':53,'firstTotal':74,'firstNumSamples':136,'firstExpected':55.53700332143,'firstChiSquared':-0.19588552041728205,'secondObserved':106,'secondTotal':138,'secondNumSamples':492,'secondExpected':87.78939231980819,'secondChiSquared':4.597949848426552},{'goid':'GO:0006281','golabel':'DNA strand break joining','gene':['APEX1','APEX2','LIG3','XRCC1','PNKP','APLF'],'firstObserved':19,'firstTotal':20,'firstNumSamples':136,'firstExpected':36.0005741958846,'firstChiSquared':-10.918403859679316,'secondObserved':25,'secondTotal':31,'secondNumSamples':492,'secondExpected':53.40942510070341,'secondChiSquared':-16.95168195182085},{'goid':'GO:0006281','golabel':'Poly(ADP-ribose) polymerase (PARP)','gene':['PARP1','PARP2','PARP3'],'firstObserved':18,'firstTotal':19,'firstNumSamples':136,'firstExpected':20.22441477095158,'firstChiSquared':-0.2873938700226915,'secondObserved':21,'secondTotal':22,'secondNumSamples':492,'secondExpected':28.71748902704271,'secondChiSquared':-2.202544920367089},{'goid':'GO:0006281','golabel':'Direct reversal of DNA damage','gene':['MGMT','ALKBH2','ALKBH3'],'firstObserved':16,'firstTotal':16,'firstNumSamples':136,'firstExpected':20.22441477095158,'firstChiSquared':-1.0365232903447745,'secondObserved':28,'secondTotal':29,'secondNumSamples':492,'secondExpected':28.71748902704271,'secondChiSquared':-0.01903720823069076,'samplesAffected':28},{'goid':'GO:0006281','golabel':'Repair of DNA-topoisomerase crosslinks','gene':['TDP1','TDP2'],'firstObserved':18,'firstTotal':18,'firstNumSamples':136,'firstExpected':14.052370390208129,'firstChiSquared':1.2367694603210744,'secondObserved':15,'secondTotal':15,'secondNumSamples':492,'secondExpected':19.642983250338524,'secondChiSquared':-1.1430928789161598,'samplesAffected':15},{'goid':'GO:0006281','golabel':'Mismatch excision repair','gene':['MSH2','MSH3','MSH6','MLH1','PMS2','MSH4','MSH5','MLH3','PMS1','PMS2L3'],'firstObserved':43,'firstTotal':56,'firstNumSamples':136,'firstExpected':52.1623051662852,'firstChiSquared':-2.610671988504092,'secondObserved':65,'secondTotal':87,'secondNumSamples':492,'secondExpected':81.4868086677341,'secondChiSquared':-3.997825850447116,'samplesAffected':65},{'goid':'GO:0006281','golabel':'Nucleotide excision repair','gene':['XPC','RAD23B','CETN2','RAD23A','XPA','DDB1','DDB2','RPA1','RPA2','RPA3','TFIIH','ERCC3','ERCC2','GTF2H1','GTF2H2','GTF2H3','HTF2H4','GTF2H5','CDK7','CCNH','MNAT1','ERCC5','34CC1','ERCC4','LIG1','NER-related','ERCC8','E4CC6','UVSSA','XAB2','MMS19'],'firstObserved':64,'firstTotal':126,'firstNumSamples':136,'firstExpected':93.69964333865461,'firstChiSquared':-30.266305349129617,'secondObserved':146,'secondTotal':296,'secondNumSamples':492,'secondExpected':175.54229829900518,'secondChiSquared':-7.729585601044667,'samplesAffected':146},{'goid':'GO:0006281','golabel':'Homologous recombination','gene':['RAD51','RAD51B','RAD51D','DMC1','XRCC2','XRCC3','RAD52','RAD54L','RAD54B','BRCA1','SHFM1','RAD50','MRE11A','NBN','RBBP8','MUS81','EME1','EME2','GIYD1','GIYD2','GEN1'],'firstObserved':86,'firstTotal':179,'firstNumSamples':136,'firstExpected':79.75208290162034,'firstChiSquared':1.1834800622206088,'secondObserved':110,'secondTotal':183,'secondNumSamples':492,'secondExpected':139.10055719689566,'secondChiSquared':-8.487657958033417,'samplesAffected':110},{'goid':'GO:0006281','golabel':'Fanconi anemia','gene':['FANCA','FANCB','FANCC','BRCA2','FANCD2','FANCE','FANCF','FANCG','FANCI','BRIP1','FANCL','FANCM','PALB2','RAD51C','BTBD12','FAAP20','FAAP24'],'firstObserved':53,'firstTotal':74,'firstNumSamples':136,'firstExpected':71.76449060935416,'firstChiSquared':-10.387898273724598,'secondObserved':127,'secondTotal':164,'secondNumSamples':492,'secondExpected':120.80806451024259,'secondChiSquared':0.4206525153580458,'samplesAffected':127},{'goid':'GO:0006281','golabel':'Non-homologous DNA end-joining','gene':['XRCC6','XRCC5','PRKDC','LIG4','XRCC4','DCLRE1C','NHEJ1'],'firstObserved':31,'firstTotal':35,'firstNumSamples':136,'firstExpected':40.494172925681866,'firstChiSquared':-3.1697921140781893,'secondObserved':60,'secondTotal':75,'secondNumSamples':492,'secondExpected':60.8986712436607,'secondChiSquared':-0.015134902048321883,'samplesAffected':60},{'goid':'GO:0006281','golabel':'Modulation of nucleotide pools','gene':['NUDT1','DUT','RRM2B'],'firstObserved':33,'firstTotal':33,'firstNumSamples':136,'firstExpected':20.22441477095158,'firstChiSquared':9.479983189100402,'secondObserved':43,'secondTotal':44,'secondNumSamples':492,'secondExpected':28.71748902704271,'secondChiSquared':7.5436558288678714,'samplesAffected':43},{'goid':'GO:0006281','golabel':'DNA polymerase','gene':['POLB','POLG','POLD1','POLE','PCNA','REV3L','MAD2L2','REV1L','POLH','POLI','POLQ','POLK','POLL','POLM','POLN'],'firstObserved':57,'firstTotal':83,'firstNumSamples':136,'firstExpected':67.01629760269542,'firstChiSquared':-2.9513887487226933,'secondObserved':151,'secondTotal':214,'secondNumSamples':492,'secondExpected':110.62921763834929,'secondChiSquared':19.005625861536846,'samplesAffected':151},{'goid':'GO:0006281','golabel':'Editing and processing nucleases','gene':['FEN1','FAN1','TREX1','TREX2','EXO1','APTX','SPO11','ENDOV'],'firstObserved':53,'firstTotal':73,'firstNumSamples':136,'firstExpected':44.66612281988055,'firstChiSquared':2.3153835851527638,'secondObserved':47,'secondTotal':54,'secondNumSamples':492,'secondExpected':68.06036182105755,'secondChiSquared':-7.563076281796253,'samplesAffected':47},{'goid':'GO:0006281','golabel':'Ubiquitination and modification','gene':['UBE2A','UBE2B','RAD18','SHPRH','HLTF','RNF168','SPRTN','RNF8','RNF4','UBE2V2','UBE2N'],'firstObserved':66,'firstTotal':105,'firstNumSamples':136,'firstExpected':55.53700332143,'firstChiSquared':3.3317502429142696,'secondObserved':98,'secondTotal':124,'secondNumSamples':492,'secondExpected':87.78939231980819,'secondChiSquared':1.4455014540277287,'samplesAffected':98},{'goid':'GO:0006281','golabel':'Chromatin structure and modification','gene':['H2AFX','CHAF1A','SETMAR'],'firstObserved':10,'firstTotal':10,'firstNumSamples':136,'firstExpected':20.22441477095158,'firstChiSquared':-6.07187578123918,'secondObserved':27,'secondTotal':29,'secondNumSamples':492,'secondExpected':28.71748902704271,'secondChiSquared':-0.10908390470080936,'samplesAffected':27},{'goid':'GO:0006281','golabel':'Sensitivity to DNA damaging agents','gene':['BLM','WRN','RECQL4','ATM','TTDN1'],'firstObserved':64,'firstTotal':80,'firstNumSamples':136,'firstExpected':31.15117209447816,'firstChiSquared':44.930442130441755,'secondObserved':104,'secondTotal':118,'secondNumSamples':492,'secondExpected':45.56820534793399,'secondChiSquared':82.57460622060226,'samplesAffected':104},{'goid':'GO:0006281','golabel':'Known/suspected DNA repair function','gene':['DCLRE1A','DCLRE1B','RPA4','PRPF19','RECQL','RECQL5','HELQ','RDM1','OBFC2B'],'firstObserved':37,'firstTotal':46,'firstNumSamples':136,'firstExpected':48.5465919536048,'firstChiSquared':-4.270817952957891,'secondObserved':51,'secondTotal':57,'secondNumSamples':492,'secondExpected':74.91646140010954,'secondChiSquared':-9.006553728219131,'samplesAffected':51,'propagate':false},{'goid':'GO:0006281','golabel':'Conserved DNA damage response','gene':['ATR','ATRIP','MDC1','RAD1','RAD9A','HUS1','RAD17','CHEK1','CHEK2','TP53','TP53BP1','RIF1','TOPBP1','CLK2','PER1'],'firstObserved':126,'firstTotal':214,'firstNumSamples':136,'firstExpected':67.01629760269542,'firstChiSquared':102.347216818351,'secondObserved':192,'secondTotal':311,'secondNumSamples':492,'secondExpected':110.62921763834929,'secondChiSquared':77.21200448556245,'samplesAffected':192,'propagate':false},{'goid':'GO:0000077','golabel':'DNA damage checkpoint','gene':['TAOK1','RPL26','DONSON','TIPIN','DDX39B','FBXO31','SOX4','HINFP','CCND1','WAC','ETAA1','BABAM2','USP28','UIMC1','CDC14B','RHNO1','BRCC3','FOXN3','CLSPN','CRADD','THOC5','FEM1B','PIDD1','ABRAXAS1','BRSK1','CCAR2','CDC5L','PLK1','RPS27L','CDKN1A','TAOK2','FZR1','HMGA2','MRNIP','CLOCK','NOP53','E2F1','THOC1','CASP2','RFWD3','NEK11','MUC1','MAP3K20','TAOK3','CDK5RAP3','TIPRL','INTS7','BABAM1','MDM2','DTL','ATF2'],'firstObserved':98,'firstTotal':301,'firstNumSamples':136,'firstExpected':108.51888599280187,'firstChiSquared':-5.045901214569492,'secondObserved':187,'secondTotal':406,'secondNumSamples':492,'secondExpected':223.7876202149424,'secondChiSquared':-11.093117518323526,'samplesAffected':187},{'goid':'GO:0048017','golabel':'PI3-K signaling','gene':['AKT1','AKT2','AKT3','BTK','GRB10','GRB2','HSPB1','ILK','MTCP1','PDK2','PDPK1','PIK3CA','PIK3CG','PIK3R1','PIK3R2','PAK1','PRKCA','PRKCB','PRKCZ','PTEN','TCL1A'],'firstObserved':85,'firstTotal':189,'firstNumSamples':136,'firstExpected':79.75208290162034,'firstChiSquared':0.8349574820865505,'secondObserved':190,'secondTotal':291,'secondNumSamples':492,'secondExpected':139.10055719689566,'secondChiSquared':25.96637451909974,'samplesAffected':190},{'goid':'GO:0016055','golabel':'Wnt signaling','gene':['AES','APC','AXIN1','BCL9','CSNK1A1','CSNK1D','CSNK1G1','CSNK2A1','CTBP1','CTBP2','CTNNB1','CTNNBIP1','CXXC4','DIXDC1','DKK1','DVL1','DVL2','EP300','FRAT1','FZD1','FZD2','FZD3','FZD4','FZD5','FZD6','FZD7','FZD8','GSK3A','GSK3B','LEF1','LRP5','LRP6','NKD1','PORCN','PPP2CA','PPP2R1A','PYGO1','SENP2','SFRP1','SFRP4','SOX17','TCF7','TCF7L1','WIF1','WNT1','WNT10A','WNT16','WNT2','WNT2B','WNT3','WNT3A','WNT4','WNT6','WNT7A','WNT7B','WNT8A'],'firstObserved':115,'firstTotal':411,'firstNumSamples':136,'firstExpected':110.82744575678224,'firstChiSquared':0.8487275138864031,'secondObserved':260,'secondTotal':651,'secondNumSamples':492,'secondExpected':232.65639093496972,'secondChiSquared':6.096579454523303,'samplesAffected':260,'propagate':false},{'goid':'GO:0097193','golabel':'Intrinsic apoptotic pathway','gene':['PTTG1IP','CHEK2','NONO','DDIAS','MOAP1','LRRK2','YBX3','S1OOAO','LGALS12','LCK','RPL26','CAV1','SOD1','DAPK2','HERPUD1','UBB','TP53','MYBBP1A','SELENOS','PLAUR','PRKN','TP53BP2','SYVN1','MPAK7','MIF','SRC','TRIM32','TP73','CHAC1','NOL3','USP28','ZNF385A','SNW1','CDKN2D','RPS3','CASP9','PMAIP1','SIAH1','MMP9','SFPQ','EPO','TMBIM6','HYOU1','BAD','DNAJC10','CCAR2','MAGEA3','SFN','PARK7','MAP3K5','ENO1','MSX1','STK25','STK11','RACK1','DNAJA1','BRCA1','PHLDA3','RPS27L','EP300','DDIT3','PDK2','PDK1','CXCL12','URI1','BRSK2','BCAP31','TNFRSF10B','MLLT11','CRIP1','NCK1','TPT1','HSPA1A','CASP4','IFI16','HIF1A','KDM1A','OPA1','CYLD','EPHA2','PPP1R13B','BCL2L11','TRIAP1','PPM1F','HTRA2','CREB3','CLU','PINK1','SLC9A3R1','CDIP1','CD74','BOK','UBQLN1','ESF1','SEPT4','FHIT','HINT1','XBP1','DDX5','ARL6IP5','P4HB','BCL3','FIS1','TMEM117','SNAI2','NACC2','BNIP3','GSDME','IKBKE','TOPORS','GSKIP','NDUFA13','SNAI1','STK24','NFE2L2','FBXO18','BCL2','SIRT1','MUC1','SELENOK','ZNF385B','BAG6','EIF2AK3','DYRK2','RRP8','HIC1','BAG5','PYCARD','TXNDC12','NOC2L','NKX3-1','AEN','MCL1','BCL2L1','BAX','ATP2A1','URS00003D1AE3_9606','NDUFS3','DNM1L','TMEM161A','TRIB3','PDCD10','MDM2','DDX3X','BCLAF1','ZNF622','CD44','FBXW7','PPIF','ACKR3','S100A8'],'firstObserved':132,'firstTotal':1099,'firstNumSamples':136,'firstExpected':126.86065451569475,'firstChiSquared':3.0982217091005926,'secondObserved':332,'secondTotal':1424,'secondNumSamples':492,'secondExpected':316.6558339671553,'secondChiSquared':2.0862813057339054,'samplesAffected':332},{'goid':'GO:0097191','golabel':'Extrinsic apoptotic pathway','gene':['HIPK1','SORT1','MOAP1','BAG3','PELI3','ERBB3','ITGAV','DEDD2','FAIM2','PSME3','CAV1','TLR3','TRAF1','HMOX1','PTEN','GSTP1','GDNF','THBS1','TMC8','IFI6','RIPK1','PAK2','MAPK7','FADD','BID','SRC','NOL3','FGG','FGB','FGA','SH3RF1','INHBA','PMAIP1','DEPTOR','IL1B','IFNG','SFRP1','FEM1B','TNFAIP3','AGT','BAD','PARK7','LTBR','UNC5B','TNF','ZMYND11','TGFBR1','ACVR1B','MADD','FAS','HTT','PHIP','BRCA1','PPP2R1B','KIAAO141','TIMP3','TNFSF10','TRAF2','PEA15','TGFB2','FASLG','TNFRSF10A','ITGA6','TERT','MLLT11','CSF2','HSPA1A','CD70','BIRC6','ICAM1','CYLD','FGFR3','LGALS3','DDX47','BCL10','HTRA2','CASP8AP2','DAB2IP','PDPK1','RNF41','SIAH2','G0S2','GPX1','SERPINE1','PML','IL12A','ATF3','SP100','ACVR1','BCL2','GATA1','CASP8','HSPA1B','RELA','TNFRSF12A','PYCARD','TNFSF12','BLOC1S2','AR','SMAD3','TRADD','MCL1','BCL2L1','BAX','SCG2','SIVA1','URS00002C6949_9606','NGF','TGFB1','CD27','RFFL','GABARAP','AGTR2','DDX3X','STX4','PF4','TMBIM1','RNF34','CFLAR','IGF1'],'firstObserved':124,'firstTotal':886,'firstNumSamples':136,'firstExpected':124.30913748095283,'firstChiSquared':-0.008943193536799954,'secondObserved':322,'secondTotal':1371,'secondNumSamples':492,'secondExpected':298.85230189283897,'secondChiSquared':4.567037525793559,'samplesAffected':322},{'goid':'GO:0022402','golabel':'Cell cycle','gene':['GSK3B','TGFB1','SMAD3','SMAD4','CD2A2','CDN1B','CCND3','CCND2','CDK4','CDK6','SCF','SKP2','ABL1','HDAC1','HDAC2','HDAC3','HDAC4','HDAC5','HDAC6','HDAC7','HDAC8','RB','E2F1','E2F2','E2F3','E2F4','E2F5','E2F6','RBL1','UBE2F','TFDP1','CCNE1','CCNE2','CDK2','CDN1A','CCNA1','CCNA2','CCNH','CDC6','ORC1','ORC2','ORC3','ORC4','ORC5','ORC6','CDC45','ARF1','MDM2','P53','EP000','PRKDC','GA45A','1433G','PCNA','MPIP1','ATR','ATM','CHK1','CHK2','CDK1','CCNB1','CCNB2','CCNB3','WEE1','PMYT1','MCM2','MCM3','MCM4','MCM5','MCM6','MCM7','MCM8','MCM9','MCM10','CDC7','DBF4A','PLK1','APC','CADH1','CC14A','CC14B','MEN1','MPIP2','MPIP3','YWHAB','YWHAE','YWHAG','YWHAH','YWHAQ','YWHAZ','BUB1','BUB3','MPEG1','BUB1B','MD1L1','MD2L2','MD2L1','SMC1A','ESPL1','PTTG3','PTTG2','PTTG1'],'firstObserved':120,'firstTotal':575,'firstNumSamples':136,'firstExpected':122.14170706932096,'firstChiSquared':-0.3685405895742125,'secondObserved':289,'secondTotal':1068,'secondNumSamples':492,'secondExpected':285.71468942655486,'secondChiSquared':0.09009840297242064,'samplesAffected':289},{'goid':'GO:0016570','golabel':'Histone modification','gene':['KANSL1','KDM5A','CTCFL','KAT2A','UBE2B','USP3','EYA3','EYA1','DOT1L','RBBP5','ACTL6A','WDR5','KDM8','SETD6','MIER2','BAP1','HASPIN','USP49','MSL2','ELK4','TAF7','TAF5','LEO1','UBE2E1','NCOA3','KMT2A','PHF19','CTBP1','MSL1','UHRF1','SETDB2','SIN3A','IWS1','BEND3','PHF20','HAT1','HDAC3','DNMT1','SART3','EYA2','KDM5C','WBP2','KAT14','ATXN7L3','PADI2','KAT8','NAA60','CTR9','CDK2','CUL4B','NSD3','SETD2','PCGF6','KANSL2','HDAC1','NR1H4','PIH1D1','REST','WAC','ING3','NTMT1','KANSL3','ATRX','UBE2N','NIPBL','OGT','ATXN7','UIMC1','WDR61','PRDM12','PRMT7','KDM6B','ELP3','SETD1A','RBM14','JAK2','EHMT1','SNW1','MSL3','BRCC3','BRPF1','HDAC6','SUPT7L','TET2','NAA40','SKR16C5','KDM4B','RYBP','USP51','FOXP3','HCFC1','KAT2B','ING5','KAT6B','CDK1','AUTS2','SETD7','KAT5','ZNF304','DTX3L','CHD5','MIER1','CHTOP','HDAC2','RNF2','CREBBP','KAT6A','EZH2','TAF1','ZNF451','KDM1A','FMR1','JADE1','KMT5A','SUV39H2','PRMT6','DPY30','DDB2','EP400','JADE2','NSD1','ZNF335','EHMT2','DDB1','TAF12','PKN1','UBE2A','RPS6KA4','ARRB1','HMGA2','SUV39H1','EPC1','RCOR1','DNMT3B','ASH2L','RUVBL1','TAF9','LEF1','PHC1','KDM5D','PAXIP1','PER1','CLOCK','COPRS','SETD1B','SMARCAD1','KMT2B','BRD7','DMAP1','RING1','ENY2','RNF40','MYSM1','ZNF274','BRD8','RPS6KA5','BAZ1B','EED','TAF5L','TADA3','NACC2','PHF8','SMYD3','MBIP','KDM7A','POLE3','PAF1','CXXC1','SIRT6','HUWE1','YEATS4','JADE3','PRMT2','USP16','H2AFY','PRKCA','HDAC11','PRKCB','TET1','NEK11','KDM5B','SIRT1','MAP3K7','MAPK3','MUC1','saga_human','CARM1','MYB','PHF1','TET3','KDM2A','TRIP12','CCNA2','KMT5B','KAT7','KDM1B','MT3','PRDM5','SNCA','MCRS1','TADA2A','KDM2B','RNF20','AKAP8','ELP4','BFD1','KMT2C','KDM4A','PHF2','USP15','TAF6L','KDM3A','TRRAP','TADA1','NOC2L','OTUB1','MORF4L1','RUVBL2','RAPGEF3','TRIM16','SPI1','BCOR','SETMAR','PRMT1','SUPT6H','HDAC4','CAMK1','SUDS3','PRKCD','DCAF1','FBL','SUPT3H','RNF168','NAA50','SUZ12','KDM4D','USP22','LIF','SMARCB1','HDAC5','HDAC10','ATF2','CDK9','HLCS','UBR5','ING4','PRMT8','POLE4','ASH1L'],'firstObserved':130,'firstTotal':1665,'firstNumSamples':136,'firstExpected':130.7722056038411,'firstChiSquared':-0.1186235341342542,'secondObserved':363,'secondTotal':2459,'secondNumSamples':492,'secondExpected':353.29540523031375,'secondChiSquared':0.9455643208870146,'samplesAffected':363},{'goid':'GO:0006979','golabel':'Oxidative stress','gene':['APTX','PTPRK','PDGFRA','SETX','PNPT1','LRRK2','SOD2','TP53','ECT2','SELENOS','PRKN','SLC25A24','MAPK7','AQP1','TPM1','CHUK','DHRS2','PLA2R1','RPS3','NET1','HDAC6','ETV5','BRF2','MMP9','SESN2','PLEKHA1','AKT1','MAPK1','VKORC1L1','ALDH3B1','RAD52','PARK7','MAP3K5','G6PD','APOA4','STK25','PYROXD1','MGST1','DAPK1','MAPK9','MAPK8','PRDX3','PRDX5','VRK2','PRKD1','PDK2','TRPM2','GBA','HIF1A','PXN','EGFR','ABL1','HTRA2','FXN','NCF1','PINK1','PARP1','ERCC6L2','ATP13A2','JUN','ARL6IP5','PYCR1','SOD1','FABP1','ATF4','GSKIP','STK24','PRDX2','NFE2L2','AKR1C3','SIRT1','CRYGD','MAPK3','RHOB','ANKZF1','CHD6','RELA','MT3','IL6','NOS3','ARNT','ZNF580','WNT16','URS0000324096_9606','FOS','PRKCD','PYCR2','TMEM161A','ANKRD2','PDCD10','ZNF622','ROMO1','RBM11','PPIF','PRR5L'],'firstObserved':131,'firstTotal':823,'firstNumSamples':136,'firstExpected':121.0867993902569,'firstChiSquared':7.401147139518208,'secondObserved':292,'secondTotal':849,'secondNumSamples':492,'secondExpected':279.8060597479949,'secondChiSquared':1.2321487339677155,'samplesAffected':292},{'goid':'GO:0007265','golabel':'Ras signaling','gene':['MAPK1','MAPK3','AKT1','AKT2','AKT3','ALK','ARHGAP35','ARHGEF2','CCND1','CCND2','CCND3','CDK4','CDK6','CNKSR1','CNKSR2','CYTH2','DUSP1','DUSP2','DUSP3','DUSP4','DUSP5','DUSP6','E2F1','E2F2','E2F3','ECT2','EGFR','EIF4EBP1','EIF4EBP2','EIF4EBP3','ERBB2','ETS1','ETS2','EXOC1','EXOC2','EXOC3','EXOC4','EXOC5','EXOC6','EXOC7','EXOC8','FGFR1','FGFR2','FGFR3','FGFR4','FLT3','FNTA','FNTB','FOS','GFB2','ICMT','INSR','INSRR','IRS1','IRS2','JUN','KSR1','KSR2','MDM2','MAP2K1','MAP2K2','MET','MLST8','MTOR','NF1','NFE2L2','NFKB1','PAK1','PAK2','PAK3','PAK4','PDGFRA','PDGFRB','PDPK1','PEBP1','PIK3CA','PICI3CB','PIK3CD','PIK3CG','PIK3R1','PIK3R2','PIK3R3','PIK3R4','PIC3R5','PIK3R6','PIN1','PLXNB1','PPP1CA','PREX2','PRKAA1','PRKAA2','PRKAB1','PRKAB2','PRKAG1','PRKAG2','PRKAG3','PTEN','RAC1','RAC2','RAC3','AFAF','BRAF','RAF1','RALA','RALB','RALBP1','RALGDS','RAPGEF1','RAPGEF2','KRAS','MRAS','NRAS','RASA1','RASA2','RASA3','RASAL1','RASAL2','RASAL3','RASGRF1','RASGRF2','RASGRP1','RASGRP2','RASGRP3','RASGRP4','RASSF1','RASSF2','RASSF3','RASSF4','RASSF5','RASSF6','RASSF7','RASSF8','RASSF9','RASSF10','RB1','RCE1','RHEB','RHOA','RHOB','RHOC','ROCK1','ROCK2','ROS1','RPS6KA1','RPS6KA2','RPS6KA3','RPS6KB1','RPS6KB2','RPTOR','SAV1','SCRIB','SHC1','SHC2','SHC3','SHC4','SHOC2','SOS1','SOS2','SPRED1','SPRED2','SPRED3','SPRY1','SPRY2','SPRY3','SPRY4','STK3','STK4','STK11','TBK1','TFDP1','TFDP2','TIAM1','TIAM2','TP53','TSC1','TSC2','VAV1','YAP1'],'firstObserved':134,'firstTotal':1553,'firstNumSamples':136,'firstExpected':128.36970184888767,'firstChiSquared':4.401469071898807,'secondObserved':384,'secondTotal':2029,'secondNumSamples':492,'secondExpected':328.9567790866979,'secondChiSquared':27.792729093945113,'samplesAffected':384},{'goid':'GO:0007179','golabel':'TGF-B signaling','gene':['WFIKKN2','PTPRK','COL1A2','CD109','FSHB','TGFBR3','CAV1','SMURF1','SKI','SKOR2','WFIKKN1','COL3A1','ZNF703','DAB2','THBS1','ADAMTSL2','ITGA3','PEG10','BAMBI','LDLRAD4','SRC','SMAD7','APOA1','IL17F','SNW1','BCL9L','ADAM17','NKX2-1','HSP90AB1','SMURF2','ITGB5','CDH5','GCNT2','ZYX','ZNF451','SDCBP','BCL9','CLDN5','STK11','TGFBR1','SMAD2','CDKN1C','CITED1','ASPN','TGFB2','MEN1','HSPA1A','SNX25','ZFYVE9','TGFBR2','SNX6','STUB1','CDKN2B','PXN','NLK','PIN1','PDPK1','ADAM9','JUN','ENG','TRIM33','SMAD4','EID2','ARRB2','ACVR1','VASN','SIRT1','PRDM16','FLCN','TWSG1','PMEPA1','ACVRL1','USP9X','PPM1A','SOX11','PBLD','STRAP','LEMD3','ING2','FERMT2','HIPK2','HPGD','TGFB3','SMAD6','TGFB1I1','USP15','SMAD3','PTK2','URS0000065D58_9606','TGFB1','FOS'],'firstObserved':119,'firstTotal':586,'firstNumSamples':136,'firstExpected':120.41471508174367,'firstChiSquared':-0.14503825522006217,'secondObserved':252,'secondTotal':796,'secondNumSamples':492,'secondExpected':276.1809249150383,'secondChiSquared':-4.826445572979136,'samplesAffected':252},{'goid':'GO:0072331','golabel':'TP53 signaling','gene':['RPL26','ATM','RRS1','UBB','NDRG1','TP53','RPS7','SOX4','MYBBP1A','PRKN','TP53BP2','PAK1IP1','NOP2','MIF','MDM4','TFAP4','TP73','USP28','PLA2R1','ZNF385A','ATR','SNW1','RPL5','PMAIP1','CRADD','SESN2','HEXIM1','PIDD1','KAT5','MAGEA2','MSX1','STK11','ANKRD1','PHLDA3','RPS27L','TWIST1','SMYD2','BOP1','EP300','CDKN1A','PDK2','MYO6','IFI16','KDM1A','KMT5A','PPP1R13B','TRIAP1','PAXIP1','CDIP1','CD74','NOP53','BCL3','E2F7','SNAI2','RPL11','CASP2','BOK','FHIT','HINT1','DDX5','FOXM1','SP100','SNAI1','RPL23','PSMD10','SIRT1','MUC1','ZNF385B','PTTG1IP','MDM2','CD44','RNF34','ING4','RPF2','BAG6','RRP8','USP10','HIPK2','CDK5RAP3','PYCARD','PYHIN1','RPS6KA6','AEN','URS000039ED8D_9606','RFFL','DYRK2'],'firstObserved':132,'firstTotal':762,'firstNumSamples':136,'firstExpected':119.49147447610773,'firstChiSquared':10.787130700402338,'secondObserved':313,'secondTotal':1016,'secondNumSamples':492,'secondExpected':271.3601975012739,'secondChiSquared':14.247951165131512,'samplesAffected':313},{'goid':'','golabel':'cell cycle (Pancan Atlas)','gene':['CDKN1A','CDKN1B','CDKN2A','CDKN2B','CDKN2C','CCND1','CCND2','CCND3','CCNE1','CDK2','CDK4','CDK6','RB1','E2F1','E2F3'],'firstObserved':87,'firstTotal':180,'firstNumSamples':136,'firstExpected':67.01629760269542,'firstChiSquared':11.747998562952759,'secondObserved':140,'secondTotal':203,'secondNumSamples':492,'secondExpected':110.62921763834929,'secondChiSquared':10.05955742695014,'samplesAffected':140},{'goid':'','golabel':'HIPPO (Pancan Atlas)','gene':['STK4','STK3','SAV1','LATS1','LATS2','MOB1A','MOB1B','YAP1','WWTR1','TEAD1','TEAD2','TEAD3','TEAD4','PTPN14','NF2','WWC1','TAOK1','TAOK2','TAOK3','CRB1','CRB2','CRB3','LLGL1','LLGL2','HMCN1','SCRIB','HIPK2','FAT1','FAT2','FAT3','FAT4','DCHS1','DCHS2','CSNK1E','CSNK1D','AJUBA','LIMD1','WTIP'],'firstObserved':115,'firstTotal':356,'firstNumSamples':136,'firstExpected':100.25136824082601,'firstChiSquared':8.254535511090204,'secondObserved':206,'secondTotal':392,'secondNumSamples':492,'secondExpected':195.3212644237039,'secondChiSquared':0.968208345753786},{'goid':'','golabel':'MYC (Pancan Atlas)','gene':['MAX','MGA','MLX','MLXIP','MLXIPL','MNT','MXD1','MXD3','MXD4','MXI1','MYC','MYCL','MYCN'],'firstObserved':89,'firstTotal':141,'firstNumSamples':136,'firstExpected':61.64567804721665,'firstChiSquared':22.20148198448672,'secondObserved':103,'secondTotal':128,'secondNumSamples':492,'secondExpected':99.65533638867049,'secondChiSquared':0.14076726859600192,'samplesAffected':103},{'goid':'','golabel':'NOTCH (Pancan Atlas)','gene':['ARRDC1','CNTN6','CREBBP','EP300','HES1','HES2','HES3','HES4','HES5','HEY1','HEY2','HEYL','KAT2B','KDM5A','NOTCH1','NOTCH2','NOTCH3','NOTCH4','NOV','NRARP','PSEN2','LFNG','ITCH','NCSTN','SPEN','JAG1','APH1A','FBXW7','FHL1','THBS2','HDAC2','MFAP2','CUL1','RFNG','NCOR1','NCOR2','MFAP5','HDAC1','NUMB','JAG2','MAML3','MFNG','CIR1','CNTN1','MAML1','MAML2','NUMBL','PSEN1','PSENEN','RBPJ','RBPJL','RBX1','SAP30','SKP1','SNW1','CTBP1','CTBP2','ADAM10','APH1B','ADAM17','DLK1','DLL1','DLL3','DLL4','DNER','DTX1','DTX2','DTX3','DTX3L','DTX4','EGFL7'],'firstObserved':126,'firstTotal':656,'firstNumSamples':136,'firstExpected':115.99727879436857,'firstChiSquared':5.864599433983892,'secondObserved':260,'secondTotal':654,'secondNumSamples':492,'secondExpected':254.51409017869747,'secondChiSquared':0.24496991596674358,'samplesAffected':260},{'goid':'','golabel':'NRF2 (Pancan Atlas)','gene':['NFE2L2','KEAP1','CUL3'],'firstObserved':18,'firstTotal':19,'firstNumSamples':136,'firstExpected':20.22441477095158,'firstChiSquared':-0.2873938700226915,'secondObserved':25,'secondTotal':27,'secondNumSamples':492,'secondExpected':28.71748902704271,'secondChiSquared':-0.5110602743332705},{'goid':'','golabel':'PI3K (Pancan Atlas)','gene':['EIF4EBP1','AKT1','AKT2','AKT3','AKT1S1','DEPDC5','DEPTOR','INPP4B','MAPKAP1','MLST8','MTOR','NPRL2','NPRL3','PDK1','PIK3CA','PIK3CB','PIK3R1','PIK3R2','PIK3R3','PPP2R1A','PTEN','RHEB','RICTOR','RPTOR','RPS6','RPS6KB1','STK11','TSC1','TSC2'],'firstObserved':111,'firstTotal':302,'firstNumSamples':136,'firstExpected':91.42545483343683,'firstChiSquared':12.786986821661891,'secondObserved':238,'secondTotal':421,'secondNumSamples':492,'secondExpected':169.12766396302538,'secondChiSquared':42.73751282476764},{'goid':'','golabel':'TGF-Beta (Pancan Atlas)','gene':['TGFBR1','TGFBR2','ACVR2A','ACVR1B','SMAD2','SMAD3','SMAD4'],'firstObserved':21,'firstTotal':24,'firstNumSamples':136,'firstExpected':40.494172925681866,'firstChiSquared':-13.363682033143364,'secondObserved':67,'secondTotal':85,'secondNumSamples':492,'secondExpected':60.8986712436607,'secondChiSquared':0.6976326176076022,'samplesAffected':67},{'goid':'','golabel':'RTK RAS (Pancan Atlas)','gene':['ABL1','EGFR','ERBB2','ERBB3','ERBB4','PDGFRA','PDGFRB','MET','FGFR1','FGFR2','FGFR3','FGFR4','FLT3','ALK','RET','ROS1','KIT','IGF1R','NTRK1','NTRK2','NTRK3','SOS1','GRB2','PTPN11','KRAS','HRAS','NRAS','RIT1','ARAF','BRAF','RAF1','RAC1','MAP2K1','MAP2K2','MAPK1','NF1','RASA1','CBL','ERRFI1','CBLB','CBLC','INSR','INSRR','IRS1','SOS2','SHC1','SHC2','SHC3','SHC4','RASGRP1','RASGRP2','RASGRP3','RASGRP4','RAPGEF1','RAPGEF2','RASGRF1','RASGRF2','FNTA','FNTB','RCE1','ICMT','MRAS','PLXNB1','MAPK3','ARHGAP35','RASA2','RASA3','RASAL1','RASAL2','RASAL3','SPRED1','SPRED2','SPRED3','DAB2IP','SHOC2','PPP1CA','SCRIB','PIN1','KSR1','KSR2','PEBP1','ERF','PEA15','JAK2','IRS2'],'firstObserved':122,'firstTotal':673,'firstNumSamples':136,'firstExpected':119.29453257346131,'firstChiSquared':0.49951019378280154,'secondObserved':265,'secondTotal':827,'secondNumSamples':492,'secondExpected':270.3541416776351,'secondChiSquared':-0.2353705776455411},{'goid':'','golabel':'TP53 (Pancan Atlas)','gene':['TP53','MDM2','MDM4','ATM','CHEK2','RPS6KA3'],'firstObserved':116,'firstTotal':148,'firstNumSamples':136,'firstExpected':36.0005741958846,'firstChiSquared':241.77183912800558,'secondObserved':150,'secondTotal':188,'secondNumSamples':492,'secondExpected':53.40942510070341,'secondChiSquared':195.95547707551532},{'goid':'','golabel':'WNT (Pancan Atlas)','gene':['CHD8','LEF1','LGR4','LGR5','LRP5','LRP6','LZTR1','NDP','PORCN','RSPO1','SFRP1','SFRP2','SFRP4','SFRP5','SOST','TCF7L1','TLE1','TLE2','TLE3','TLE4','WIF1','ZNRF3','CTNNB1','DVL1','DVL2','DVL3','FRAT1','FRAT2','FZD1','FZD10','FZD2','FZD3','FZD4','FZD5','FZD6','FZD7','FZD8','FZD9','WNT1','WNT10A','WNT10B','WNT11','WNT16','WNT2','WNT3A','WNT4','WNT5A','WNT5B','WNT6','WNT7A','WNT7B','WNT8A','WNT8B','WNT9A','WNT9B','AMER1','APC','AXIN1','AXIN2','DKK1','DKK2','DKK3','DKK4','GSK3B','RNF43','TCF7','TCF7L2','CHD4'],'firstObserved':117,'firstTotal':446,'firstNumSamples':136,'firstExpected':115.12856126958182,'firstChiSquared':0.19822328541901846,'secondObserved':268,'secondTotal':799,'secondNumSamples':492,'secondExpected':250.61597514029555,'secondChiSquared':2.457811070394433}];
    const geneList = ['DLL1','DTX1','JAG1','JAG2','ADAM10','PSEN1','PSEN2','PSENEN','LATS2','MOB1B','MOB1A','SAV1','STK3','STK4','TAZ','YAP1','MST1','WWTR1','UNG','SMUG1','MBD4','TDG','OGG1','MUTYH','NTHL1','MPG','NEIL1','NEIL2','NEIL3','APEX1','APEX2','LIG3','XRCC1','PNKP','APLF','PARP1','PARP2','PARP3','MGMT','ALKBH2','ALKBH3','TDP1','TDP2','MSH2','MSH3','MSH6','MLH1','PMS2','MSH4','MSH5','MLH3','PMS1','PMS2L3','XPC','RAD23B','CETN2','RAD23A','XPA','DDB1','DDB2','RPA1','RPA2','RPA3','TFIIH','ERCC3','ERCC2','GTF2H1','GTF2H2','GTF2H3','HTF2H4','GTF2H5','CDK7','CCNH','MNAT1','ERCC5','34CC1','ERCC4','LIG1','NER-related','ERCC8','E4CC6','UVSSA','XAB2','MMS19','RAD51','RAD51B','RAD51D','DMC1','XRCC2','XRCC3','RAD52','RAD54L','RAD54B','BRCA1','SHFM1','RAD50','MRE11A','NBN','RBBP8','MUS81','EME1','EME2','GIYD1','GIYD2','GEN1','FANCA','FANCB','FANCC','BRCA2','FANCD2','FANCE','FANCF','FANCG','FANCI','BRIP1','FANCL','FANCM','PALB2','RAD51C','BTBD12','FAAP20','FAAP24','XRCC6','XRCC5','PRKDC','LIG4','XRCC4','DCLRE1C','NHEJ1','NUDT1','DUT','RRM2B','POLB','POLG','POLD1','POLE','PCNA','REV3L','MAD2L2','REV1L','POLH','POLI','POLQ','POLK','POLL','POLM','POLN','FEN1','FAN1','TREX1','TREX2','EXO1','APTX','SPO11','ENDOV','UBE2A','UBE2B','RAD18','SHPRH','HLTF','RNF168','SPRTN','RNF8','RNF4','UBE2V2','UBE2N','H2AFX','CHAF1A','SETMAR','BLM','WRN','RECQL4','ATM','TTDN1','DCLRE1A','DCLRE1B','RPA4','PRPF19','RECQL','RECQL5','HELQ','RDM1','OBFC2B','ATR','ATRIP','MDC1','RAD1','RAD9A','HUS1','RAD17','CHEK1','CHEK2','TP53','TP53BP1','RIF1','TOPBP1','CLK2','PER1','TAOK1','RPL26','DONSON','TIPIN','DDX39B','FBXO31','SOX4','HINFP','CCND1','WAC','ETAA1','BABAM2','USP28','UIMC1','CDC14B','RHNO1','BRCC3','FOXN3','CLSPN','CRADD','THOC5','FEM1B','PIDD1','ABRAXAS1','BRSK1','CCAR2','CDC5L','PLK1','RPS27L','CDKN1A','TAOK2','FZR1','HMGA2','MRNIP','CLOCK','NOP53','E2F1','THOC1','CASP2','RFWD3','NEK11','MUC1','MAP3K20','TAOK3','CDK5RAP3','TIPRL','INTS7','BABAM1','MDM2','DTL','ATF2','AKT1','AKT2','AKT3','BTK','GRB10','GRB2','HSPB1','ILK','MTCP1','PDK2','PDPK1','PIK3CA','PIK3CG','PIK3R1','PIK3R2','PAK1','PRKCA','PRKCB','PRKCZ','PTEN','TCL1A','AES','APC','AXIN1','BCL9','CSNK1A1','CSNK1D','CSNK1G1','CSNK2A1','CTBP1','CTBP2','CTNNB1','CTNNBIP1','CXXC4','DIXDC1','DKK1','DVL1','DVL2','EP300','FRAT1','FZD1','FZD2','FZD3','FZD4','FZD5','FZD6','FZD7','FZD8','GSK3A','GSK3B','LEF1','LRP5','LRP6','NKD1','PORCN','PPP2CA','PPP2R1A','PYGO1','SENP2','SFRP1','SFRP4','SOX17','TCF7','TCF7L1','WIF1','WNT1','WNT10A','WNT16','WNT2','WNT2B','WNT3','WNT3A','WNT4','WNT6','WNT7A','WNT7B','WNT8A','PTTG1IP','NONO','DDIAS','MOAP1','LRRK2','YBX3','S1OOAO','LGALS12','LCK','CAV1','SOD1','DAPK2','HERPUD1','UBB','MYBBP1A','SELENOS','PLAUR','PRKN','TP53BP2','SYVN1','MPAK7','MIF','SRC','TRIM32','TP73','CHAC1','NOL3','ZNF385A','SNW1','CDKN2D','RPS3','CASP9','PMAIP1','SIAH1','MMP9','SFPQ','EPO','TMBIM6','HYOU1','BAD','DNAJC10','MAGEA3','SFN','PARK7','MAP3K5','ENO1','MSX1','STK25','STK11','RACK1','DNAJA1','PHLDA3','DDIT3','PDK1','CXCL12','URI1','BRSK2','BCAP31','TNFRSF10B','MLLT11','CRIP1','NCK1','TPT1','HSPA1A','CASP4','IFI16','HIF1A','KDM1A','OPA1','CYLD','EPHA2','PPP1R13B','BCL2L11','TRIAP1','PPM1F','HTRA2','CREB3','CLU','PINK1','SLC9A3R1','CDIP1','CD74','BOK','UBQLN1','ESF1','SEPT4','FHIT','HINT1','XBP1','DDX5','ARL6IP5','P4HB','BCL3','FIS1','TMEM117','SNAI2','NACC2','BNIP3','GSDME','IKBKE','TOPORS','GSKIP','NDUFA13','SNAI1','STK24','NFE2L2','FBXO18','BCL2','SIRT1','SELENOK','ZNF385B','BAG6','EIF2AK3','DYRK2','RRP8','HIC1','BAG5','PYCARD','TXNDC12','NOC2L','NKX3-1','AEN','MCL1','BCL2L1','BAX','ATP2A1','URS00003D1AE3_9606','NDUFS3','DNM1L','TMEM161A','TRIB3','PDCD10','DDX3X','BCLAF1','ZNF622','CD44','FBXW7','PPIF','ACKR3','S100A8','HIPK1','SORT1','BAG3','PELI3','ERBB3','ITGAV','DEDD2','FAIM2','PSME3','TLR3','TRAF1','HMOX1','GSTP1','GDNF','THBS1','TMC8','IFI6','RIPK1','PAK2','MAPK7','FADD','BID','FGG','FGB','FGA','SH3RF1','INHBA','DEPTOR','IL1B','IFNG','TNFAIP3','AGT','LTBR','UNC5B','TNF','ZMYND11','TGFBR1','ACVR1B','MADD','FAS','HTT','PHIP','PPP2R1B','KIAAO141','TIMP3','TNFSF10','TRAF2','PEA15','TGFB2','FASLG','TNFRSF10A','ITGA6','TERT','CSF2','CD70','BIRC6','ICAM1','FGFR3','LGALS3','DDX47','BCL10','CASP8AP2','DAB2IP','RNF41','SIAH2','G0S2','GPX1','SERPINE1','PML','IL12A','ATF3','SP100','ACVR1','GATA1','CASP8','HSPA1B','RELA','TNFRSF12A','TNFSF12','BLOC1S2','AR','SMAD3','TRADD','SCG2','SIVA1','URS00002C6949_9606','NGF','TGFB1','CD27','RFFL','GABARAP','AGTR2','STX4','PF4','TMBIM1','RNF34','CFLAR','IGF1','SMAD4','CD2A2','CDN1B','CCND3','CCND2','CDK4','CDK6','SCF','SKP2','ABL1','HDAC1','HDAC2','HDAC3','HDAC4','HDAC5','HDAC6','HDAC7','HDAC8','RB','E2F2','E2F3','E2F4','E2F5','E2F6','RBL1','UBE2F','TFDP1','CCNE1','CCNE2','CDK2','CDN1A','CCNA1','CCNA2','CDC6','ORC1','ORC2','ORC3','ORC4','ORC5','ORC6','CDC45','ARF1','P53','EP000','GA45A','1433G','MPIP1','CHK1','CHK2','CDK1','CCNB1','CCNB2','CCNB3','WEE1','PMYT1','MCM2','MCM3','MCM4','MCM5','MCM6','MCM7','MCM8','MCM9','MCM10','CDC7','DBF4A','CADH1','CC14A','CC14B','MEN1','MPIP2','MPIP3','YWHAB','YWHAE','YWHAG','YWHAH','YWHAQ','YWHAZ','BUB1','BUB3','MPEG1','BUB1B','MD1L1','MD2L2','MD2L1','SMC1A','ESPL1','PTTG3','PTTG2','PTTG1','KANSL1','KDM5A','CTCFL','KAT2A','USP3','EYA3','EYA1','DOT1L','RBBP5','ACTL6A','WDR5','KDM8','SETD6','MIER2','BAP1','HASPIN','USP49','MSL2','ELK4','TAF7','TAF5','LEO1','UBE2E1','NCOA3','KMT2A','PHF19','MSL1','UHRF1','SETDB2','SIN3A','IWS1','BEND3','PHF20','HAT1','DNMT1','SART3','EYA2','KDM5C','WBP2','KAT14','ATXN7L3','PADI2','KAT8','NAA60','CTR9','CUL4B','NSD3','SETD2','PCGF6','KANSL2','NR1H4','PIH1D1','REST','ING3','NTMT1','KANSL3','ATRX','NIPBL','OGT','ATXN7','WDR61','PRDM12','PRMT7','KDM6B','ELP3','SETD1A','RBM14','JAK2','EHMT1','MSL3','BRPF1','SUPT7L','TET2','NAA40','SKR16C5','KDM4B','RYBP','USP51','FOXP3','HCFC1','KAT2B','ING5','KAT6B','AUTS2','SETD7','KAT5','ZNF304','DTX3L','CHD5','MIER1','CHTOP','RNF2','CREBBP','KAT6A','EZH2','TAF1','ZNF451','FMR1','JADE1','KMT5A','SUV39H2','PRMT6','DPY30','EP400','JADE2','NSD1','ZNF335','EHMT2','TAF12','PKN1','RPS6KA4','ARRB1','SUV39H1','EPC1','RCOR1','DNMT3B','ASH2L','RUVBL1','TAF9','PHC1','KDM5D','PAXIP1','COPRS','SETD1B','SMARCAD1','KMT2B','BRD7','DMAP1','RING1','ENY2','RNF40','MYSM1','ZNF274','BRD8','RPS6KA5','BAZ1B','EED','TAF5L','TADA3','PHF8','SMYD3','MBIP','KDM7A','POLE3','PAF1','CXXC1','SIRT6','HUWE1','YEATS4','JADE3','PRMT2','USP16','H2AFY','HDAC11','TET1','KDM5B','MAP3K7','MAPK3','saga_human','CARM1','MYB','PHF1','TET3','KDM2A','TRIP12','KMT5B','KAT7','KDM1B','MT3','PRDM5','SNCA','MCRS1','TADA2A','KDM2B','RNF20','AKAP8','ELP4','BFD1','KMT2C','KDM4A','PHF2','USP15','TAF6L','KDM3A','TRRAP','TADA1','OTUB1','MORF4L1','RUVBL2','RAPGEF3','TRIM16','SPI1','BCOR','PRMT1','SUPT6H','CAMK1','SUDS3','PRKCD','DCAF1','FBL','SUPT3H','NAA50','SUZ12','KDM4D','USP22','LIF','SMARCB1','HDAC10','CDK9','HLCS','UBR5','ING4','PRMT8','POLE4','ASH1L','PTPRK','PDGFRA','SETX','PNPT1','SOD2','ECT2','SLC25A24','AQP1','TPM1','CHUK','DHRS2','PLA2R1','NET1','ETV5','BRF2','SESN2','PLEKHA1','MAPK1','VKORC1L1','ALDH3B1','G6PD','APOA4','PYROXD1','MGST1','DAPK1','MAPK9','MAPK8','PRDX3','PRDX5','VRK2','PRKD1','TRPM2','GBA','PXN','EGFR','FXN','NCF1','ERCC6L2','ATP13A2','JUN','PYCR1','FABP1','ATF4','PRDX2','AKR1C3','CRYGD','RHOB','ANKZF1','CHD6','IL6','NOS3','ARNT','ZNF580','URS0000324096_9606','FOS','PYCR2','ANKRD2','ROMO1','RBM11','PRR5L','ALK','ARHGAP35','ARHGEF2','CNKSR1','CNKSR2','CYTH2','DUSP1','DUSP2','DUSP3','DUSP4','DUSP5','DUSP6','EIF4EBP1','EIF4EBP2','EIF4EBP3','ERBB2','ETS1','ETS2','EXOC1','EXOC2','EXOC3','EXOC4','EXOC5','EXOC6','EXOC7','EXOC8','FGFR1','FGFR2','FGFR4','FLT3','FNTA','FNTB','GFB2','ICMT','INSR','INSRR','IRS1','IRS2','KSR1','KSR2','MAP2K1','MAP2K2','MET','MLST8','MTOR','NF1','NFKB1','PAK3','PAK4','PDGFRB','PEBP1','PICI3CB','PIK3CD','PIK3R3','PIK3R4','PIC3R5','PIK3R6','PIN1','PLXNB1','PPP1CA','PREX2','PRKAA1','PRKAA2','PRKAB1','PRKAB2','PRKAG1','PRKAG2','PRKAG3','RAC1','RAC2','RAC3','AFAF','BRAF','RAF1','RALA','RALB','RALBP1','RALGDS','RAPGEF1','RAPGEF2','KRAS','MRAS','NRAS','RASA1','RASA2','RASA3','RASAL1','RASAL2','RASAL3','RASGRF1','RASGRF2','RASGRP1','RASGRP2','RASGRP3','RASGRP4','RASSF1','RASSF2','RASSF3','RASSF4','RASSF5','RASSF6','RASSF7','RASSF8','RASSF9','RASSF10','RB1','RCE1','RHEB','RHOA','RHOC','ROCK1','ROCK2','ROS1','RPS6KA1','RPS6KA2','RPS6KA3','RPS6KB1','RPS6KB2','RPTOR','SCRIB','SHC1','SHC2','SHC3','SHC4','SHOC2','SOS1','SOS2','SPRED1','SPRED2','SPRED3','SPRY1','SPRY2','SPRY3','SPRY4','TBK1','TFDP2','TIAM1','TIAM2','TSC1','TSC2','VAV1','WFIKKN2','COL1A2','CD109','FSHB','TGFBR3','SMURF1','SKI','SKOR2','WFIKKN1','COL3A1','ZNF703','DAB2','ADAMTSL2','ITGA3','PEG10','BAMBI','LDLRAD4','SMAD7','APOA1','IL17F','BCL9L','ADAM17','NKX2-1','HSP90AB1','SMURF2','ITGB5','CDH5','GCNT2','ZYX','SDCBP','CLDN5','SMAD2','CDKN1C','CITED1','ASPN','SNX25','ZFYVE9','TGFBR2','SNX6','STUB1','CDKN2B','NLK','ADAM9','ENG','TRIM33','EID2','ARRB2','VASN','PRDM16','FLCN','TWSG1','PMEPA1','ACVRL1','USP9X','PPM1A','SOX11','PBLD','STRAP','LEMD3','ING2','FERMT2','HIPK2','HPGD','TGFB3','SMAD6','TGFB1I1','PTK2','URS0000065D58_9606','RRS1','NDRG1','RPS7','PAK1IP1','NOP2','MDM4','TFAP4','RPL5','HEXIM1','MAGEA2','ANKRD1','TWIST1','SMYD2','BOP1','MYO6','E2F7','RPL11','FOXM1','RPL23','PSMD10','RPF2','USP10','PYHIN1','RPS6KA6','URS000039ED8D_9606','CDKN1B','CDKN2A','CDKN2C','LATS1','TEAD1','TEAD2','TEAD3','TEAD4','PTPN14','NF2','WWC1','CRB1','CRB2','CRB3','LLGL1','LLGL2','HMCN1','FAT1','FAT2','FAT3','FAT4','DCHS1','DCHS2','CSNK1E','AJUBA','LIMD1','WTIP','MAX','MGA','MLX','MLXIP','MLXIPL','MNT','MXD1','MXD3','MXD4','MXI1','MYC','MYCL','MYCN','ARRDC1','CNTN6','HES1','HES2','HES3','HES4','HES5','HEY1','HEY2','HEYL','NOTCH1','NOTCH2','NOTCH3','NOTCH4','NOV','NRARP','LFNG','ITCH','NCSTN','SPEN','APH1A','FHL1','THBS2','MFAP2','CUL1','RFNG','NCOR1','NCOR2','MFAP5','NUMB','MAML3','MFNG','CIR1','CNTN1','MAML1','MAML2','NUMBL','RBPJ','RBPJL','RBX1','SAP30','SKP1','APH1B','DLK1','DLL3','DLL4','DNER','DTX2','DTX3','DTX4','EGFL7','KEAP1','CUL3','AKT1S1','DEPDC5','INPP4B','MAPKAP1','NPRL2','NPRL3','PIK3CB','RICTOR','RPS6','ACVR2A','ERBB4','RET','KIT','IGF1R','NTRK1','NTRK2','NTRK3','PTPN11','HRAS','RIT1','ARAF','CBL','ERRFI1','CBLB','CBLC','ERF','CHD8','LGR4','LGR5','LZTR1','NDP','RSPO1','SFRP2','SFRP5','SOST','TLE1','TLE2','TLE3','TLE4','ZNRF3','DVL3','FRAT2','FZD10','FZD9','WNT10B','WNT11','WNT5A','WNT5B','WNT8B','WNT9A','WNT9B','AMER1','AXIN2','DKK2','DKK3','DKK4','RNF43','TCF7L2','CHD4'];
    expect(geneList).toEqual(getGenesForPathways(inputPathways));
  });

  it('Get Names Genes For Pathway', () => {
    const selectedPathways = ['Sensitivity to DNA damaging agents'];
    const geneList = ['BLM','WRN','RECQL4','ATM','TTDN1'];
    expect(geneList).toEqual(getGenesForNamedPathways(selectedPathways,SamplePathway1));
  });

  it('Get samples from selected sub', () => {
    let subSamples = getSamplesFromSelectedSubCohorts(BREAST_SUBCOHORTS);
    expect(subSamples.length).toEqual(219);
  });

  it('Calculate samples with all sub cohorts', () => {
    const cohort = {'name':'TCGA Ovarian Cancer (OV)','mutationDataSetId':'TCGA.OV.sampleMap/mutation_wustl','copyNumberDataSetId':'TCGA.OV.sampleMap/Gistic2_CopyNumber_Gistic2_all_thresholded.by_genes','genomeBackgroundCopyNumber':{'host':'https://xenago.xenahubs.net','dataset':'cnv_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'genomeBackgroundMutation':{'host':'https://xenago.xenahubs.net','dataset':'mutation_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'amplificationThreshold':2,'deletionThreshold':-2,'host':'https://tcga.xenahubs.net','subCohorts':['OVCA.Differentiated','OVCA.Immunoreactive','OVCA.Mesenchymal','OVCA.Proliferative'],'selectedSubCohorts':['OVCA.Differentiated','OVCA.Immunoreactive','OVCA.Mesenchymal','OVCA.Proliferative']};
    const calculatedSubCohort = ['TCGA-04-1638-01','TCGA-04-1648-01','TCGA-04-1649-01','TCGA-04-1651-01','TCGA-04-1652-01','TCGA-09-1670-01','TCGA-20-1686-01','TCGA-20-1687-01','TCGA-23-1029-01','TCGA-23-1111-01','TCGA-24-1844-01','TCGA-24-1845-01','TCGA-29-1694-01','TCGA-29-1696-01','TCGA-29-1771-01','TCGA-29-1776-01','TCGA-29-1778-01','TCGA-30-1714-01','TCGA-61-1899-01','TCGA-61-1901-01','TCGA-61-1904-01','TCGA-61-1906-01','TCGA-61-1910-01','TCGA-20-1685-01','TCGA-24-1842-01','TCGA-24-1843-01','TCGA-24-1846-01','TCGA-24-1847-01','TCGA-29-1688-01','TCGA-29-1699-01','TCGA-29-1701-01','TCGA-29-1707-01','TCGA-29-1710-01','TCGA-29-1711-01','TCGA-29-1761-01','TCGA-29-1769-01','TCGA-29-1781-01','TCGA-29-1784-01','TCGA-29-1785-01','TCGA-30-1855-01','TCGA-30-1856-01','TCGA-61-1725-01','TCGA-61-1738-01','TCGA-61-1740-01','TCGA-61-1895-01','TCGA-61-1907-01','TCGA-61-1911-01','TCGA-61-1913-01','TCGA-61-1914-01','TCGA-61-1915-01','TCGA-20-1682-01','TCGA-24-1849-01','TCGA-29-1690-01','TCGA-29-1693-01','TCGA-29-1695-01','TCGA-29-1698-01','TCGA-29-1705-01','TCGA-29-1764-01','TCGA-29-1766-01','TCGA-29-1768-01','TCGA-29-1770-01','TCGA-29-1777-01','TCGA-29-1783-01','TCGA-30-1718-01','TCGA-30-1857-01','TCGA-61-1733-01','TCGA-61-1737-01','TCGA-04-1646-01','TCGA-04-1655-01','TCGA-09-1673-01','TCGA-09-1674-01','TCGA-20-1683-01','TCGA-20-1684-01','TCGA-23-1114-01','TCGA-23-1809-01','TCGA-24-1850-01','TCGA-29-1691-01','TCGA-29-1697-01','TCGA-29-1702-01','TCGA-29-1703-01','TCGA-29-1762-01','TCGA-29-1763-01','TCGA-29-1774-01','TCGA-29-1775-01','TCGA-57-1586-01','TCGA-61-1741-01','TCGA-61-1900-01'];
    expect(calculateSelectedSubCohortSamples(TEST_AVAILABLE_OVARIAN_SAMPLES,cohort)).toEqual(calculatedSubCohort);
  });

  it('Calculate samples with ONE sub cohorts', () => {
    const cohort = {'name':'TCGA Ovarian Cancer (OV)','mutationDataSetId':'TCGA.OV.sampleMap/mutation_wustl','copyNumberDataSetId':'TCGA.OV.sampleMap/Gistic2_CopyNumber_Gistic2_all_thresholded.by_genes','genomeBackgroundCopyNumber':{'host':'https://xenago.xenahubs.net','dataset':'cnv_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'genomeBackgroundMutation':{'host':'https://xenago.xenahubs.net','dataset':'mutation_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'amplificationThreshold':2,'deletionThreshold':-2,'host':'https://tcga.xenahubs.net','subCohorts':['OVCA.Differentiated','OVCA.Immunoreactive','OVCA.Mesenchymal','OVCA.Proliferative'],'selectedSubCohorts':['OVCA.Differentiated']};
    const calculatedSubCohort = ['TCGA-04-1638-01','TCGA-04-1648-01','TCGA-04-1649-01','TCGA-04-1651-01','TCGA-04-1652-01','TCGA-09-1670-01','TCGA-20-1686-01','TCGA-20-1687-01','TCGA-23-1029-01','TCGA-23-1111-01','TCGA-24-1844-01','TCGA-24-1845-01','TCGA-29-1694-01','TCGA-29-1696-01','TCGA-29-1771-01','TCGA-29-1776-01','TCGA-29-1778-01','TCGA-30-1714-01','TCGA-61-1899-01','TCGA-61-1901-01','TCGA-61-1904-01','TCGA-61-1906-01','TCGA-61-1910-01'];
    expect(calculateSelectedSubCohortSamples(TEST_AVAILABLE_OVARIAN_SAMPLES,cohort)).toEqual(calculatedSubCohort);
  });

  it('Calculate samples without sub cohorts', () => {
    const cohort = {'name':'TCGA Mesothelioma (MESO)','mutationDataSetId':'TCGA.MESO.sampleMap/mutation_broad','copyNumberDataSetId':'TCGA.MESO.sampleMap/Gistic2_CopyNumber_Gistic2_all_thresholded.by_genes','genomeBackgroundCopyNumber':{'host':'https://xenago.xenahubs.net','dataset':'cnv_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'genomeBackgroundMutation':{'host':'https://xenago.xenahubs.net','dataset':'mutation_sampleEvent','feature_event_K':'event_K','feature_total_pop_N':'total_pop_N'},'amplificationThreshold':2,'deletionThreshold':-2,'host':'https://tcga.xenahubs.net','subCohorts':[],'selectedSubCohorts':[]};
    expect(calculateSelectedSubCohortSamples(TEST_MESOTHELIOMA_SAMPLES,cohort)).toEqual(TEST_MESOTHELIOMA_SAMPLES);
  });

  it('change to non gene expression from either cohort', () =>{
    expect(matchFilters([FILTER_ENUM.GENE_EXPRESSION,FILTER_ENUM.GENE_EXPRESSION],FILTER_ENUM.MUTATION,0)).toEqual([FILTER_ENUM.MUTATION,FILTER_ENUM.MUTATION]);
    expect(matchFilters([FILTER_ENUM.GENE_EXPRESSION,FILTER_ENUM.GENE_EXPRESSION],FILTER_ENUM.MUTATION,1)).toEqual([FILTER_ENUM.MUTATION,FILTER_ENUM.MUTATION]);
  });

  it('change and match filters 2', () =>{
    expect(matchFilters([FILTER_ENUM.COPY_NUMBER,FILTER_ENUM.MUTATION],FILTER_ENUM.CNV_MUTATION,0)).toEqual([FILTER_ENUM.CNV_MUTATION,FILTER_ENUM.MUTATION]);
    expect(matchFilters([FILTER_ENUM.COPY_NUMBER,FILTER_ENUM.MUTATION],FILTER_ENUM.GENE_EXPRESSION,0)).toEqual([FILTER_ENUM.GENE_EXPRESSION,FILTER_ENUM.GENE_EXPRESSION]);
    expect(matchFilters([FILTER_ENUM.COPY_NUMBER,FILTER_ENUM.MUTATION],FILTER_ENUM.CNV_MUTATION,1)).toEqual([FILTER_ENUM.COPY_NUMBER,FILTER_ENUM.CNV_MUTATION]);
    expect(matchFilters([FILTER_ENUM.COPY_NUMBER,FILTER_ENUM.MUTATION],FILTER_ENUM.GENE_EXPRESSION,1)).toEqual([FILTER_ENUM.GENE_EXPRESSION,FILTER_ENUM.GENE_EXPRESSION]);
  });

});

